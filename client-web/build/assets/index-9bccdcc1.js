import{l as e,a6 as F,a3 as w,X as p,an as H,Y as W,ag as O,ah as U,a5 as x,ai as J,k as u,O as P,au as M,S as b,aw as X,a7 as Y,ax as V,ay as $,N as h,ar as G,aa as z,av as L,az as K,aA as Q,aj as k,U as Z,aB as ee,aC as oe,aD as te}from"./index-451a7b86.js";import{d as N}from"./Edit-95ac8ddb.js";import{D as se}from"./DeleteDialog-2ce8ffe5.js";const ne={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",boxShadow:24,p:4,justifyContent:"center",display:"flex",flexDirection:"column",borderRadius:"10px"};function E({title:n,open:C,onClose:t,onChange:c,onSubmit:r}){return e.jsx(F,{open:C,onClose:t,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs(w,{sx:ne,children:[e.jsx(p,{id:"modal-modal-title",variant:"h6",component:"h2",children:n}),e.jsx(H,{onChange:m=>c(m.target.value),margin:"normal",id:"outlined-basic",label:"Enter new info here",variant:"outlined"}),e.jsx(W,{onClick:r,style:{justifyContent:"center",alignItems:"center",display:"flex"},variant:"contained",children:e.jsx(p,{id:"modal-modal-description",children:"Submit"})})]})})}var T={},ae=U;Object.defineProperty(T,"__esModule",{value:!0});var q=T.default=void 0,le=ae(O()),ie=e,re=(0,le.default)((0,ie.jsx)("path",{d:"m12 8.89.94 3.11h2.82l-2.27 1.62.93 3.01L12 14.79l-2.42 1.84.93-3.01L8.24 12h2.82L12 8.89M12 2l-2.42 8H2l6.17 4.41L5.83 22 12 17.31 18.18 22l-2.35-7.59L22 10h-7.58L12 2z"}),"StarPurple500");q=T.default=re;var A={},ce=U;Object.defineProperty(A,"__esModule",{value:!0});var B=A.default=void 0,de=ce(O()),ue=e,he=(0,de.default)((0,ue.jsx)("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"}),"InsertPhoto");B=A.default=he;function fe({roomJID:n,onDeleteRoomClick:C}){var D;const t=x(s=>s.userChatRooms).find(s=>(s==null?void 0:s.jid)===n),c=x(s=>s.updateUserChatRoom),r=x(s=>s.roomRoles),{showSnackbar:m}=J(),f=(D=r.find(s=>s.roomJID===(t==null?void 0:t.jid)))==null?void 0:D.role,_=u.useRef(null),[S,v]=u.useState(!1),j=P(),i=t&&(t.group===M.official||t.group===M.favourite),g=f==="moderator"||f==="owner"||f==="admin",R=s=>{const d=Object.assign({},t);d.group=s,c(d);const o=x.getState().userChatRooms.filter(a=>a.group===M.favourite);h.setPrivateXmlRooms(o)},y=s=>{g&&j.push("/changebg/"+n)},I=async s=>{const d=new FormData;d.append("files",s),v("chatIcon");try{const o=await G(d),a=n.split("@")[0];h.setRoomImage(a,o.data.results[0].location,t.room_background,"icon");const l=Object.assign({},t);l.room_thumbnail=o.data.results[0].location,c(l),m("success","Success! The chat icon was set")}catch(o){console.log(o),m("error","An error occurred while loading the image.  ( "+o.message+" "+o.response.data+" )")}v(!1)};return e.jsx("div",{style:{cursor:"pointer"},children:e.jsxs(w,{sx:{width:200,height:200,margin:5,backgroundColor:"primary.dark",justifyContent:"center",alignItems:"center",display:"flex",borderRadius:"10px",position:"relative"},children:[e.jsxs(w,{sx:{position:"absolute",top:0,right:0,display:"flex",flexDirection:"column",zIndex:99999},children:[e.jsx(b,{sx:{color:"white"},onClick:()=>R(i?"":M.favourite),children:i?e.jsx(X,{}):e.jsx(q,{})}),g&&e.jsxs(b,{sx:{color:"white"},onClick:()=>{var s;return(s=_.current)==null?void 0:s.click()},children:[e.jsx("input",{type:"file",name:"file",id:"file",onChange:s=>I(s.target.files[0]),ref:_,style:{display:"none"},accept:"image/*"}),S==="chatIcon"?e.jsx(Y,{style:{color:"white"},size:24}):e.jsx(B,{})]}),g&&e.jsx(b,{sx:{color:"red"},onClick:C,children:e.jsx(V,{})})]}),e.jsx(b,{disableRipple:!0,onClick:y,children:t!=null&&t.room_thumbnail&&(t==null?void 0:t.room_thumbnail)!=="none"?e.jsx($,{sx:{width:200,height:200,borderRadius:"10px"},variant:"square",src:t.room_thumbnail}):e.jsx(p,{color:"white",fontSize:"120px",children:t==null?void 0:t.name[0]})})]})})}function pe(){var a;const{roomJID:n}=z(),[C,t]=u.useState(""),[c,r]=u.useState(""),[m,f]=u.useState(!1),[_,S]=u.useState(!1),[v,j]=u.useState(!1),i=x(l=>l.userChatRooms).find(l=>(l==null?void 0:l.jid)===n),g=x(l=>l.roomRoles),R=P(),y=(a=g.find(l=>l.roomJID===(i==null?void 0:i.jid)))==null?void 0:a.role,I=y==="moderator"||y==="owner"||y==="admin",D=l=>{h.changeRoomDescription(n,l)},s=l=>{h.changeRoomName(n,l)},d=()=>{S(!1)},o=async()=>{h.leaveTheRoom(n),h.unsubscribe(n),d(),R.push("/chat/none")};return e.jsxs(L,{style:{justifyContent:"center",alignItems:"center",display:"flex",flexDirection:"column"},children:[e.jsx(fe,{roomJID:n,onDeleteRoomClick:()=>S(!0)}),e.jsxs(w,{flexDirection:"row",display:"flex",children:[e.jsx(p,{fontSize:"20px",fontWeight:"bold",children:i==null?void 0:i.name}),I&&e.jsx(b,{onClick:()=>j(!0),style:{marginLeft:10},children:e.jsx(N,{fontSize:"small"})})]}),e.jsxs(L,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center",display:"flex"},children:[e.jsx(p,{fontSize:"20px",children:i!=null&&i.description?i.description:"No description"}),I&&e.jsx(b,{onClick:()=>f(!0),style:{marginLeft:10},children:e.jsx(N,{fontSize:"small"})})]}),e.jsx(E,{title:"Set New Chat Name",open:v,onClose:()=>j(!1),onChange:r,onSubmit:()=>{j(!1),s(c)}}),e.jsx(E,{title:"Set New Chat Description",open:m,onClose:()=>f(!1),onChange:t,onSubmit:()=>{f(!1),D(C)}}),e.jsx(se,{open:_,title:"Delete",description:"Do you want to delete this room?",onDeletePress:o,onClose:d})]})}function xe(){var d;const{roomJID:n}=z(),C=x(o=>o.userChatRooms),t=x(o=>o.roomMemberInfo.filter(a=>a.name!=="none")),c=x(o=>o.user),r=C.find(o=>(o==null?void 0:o.jid)===n),[m,f]=u.useState(!1),[_,S]=u.useState(),[v,j]=u.useState(null),i=x(o=>o.roomRoles),g=P(),R=(d=i.find(o=>o.roomJID===(r==null?void 0:r.jid)))==null?void 0:d.role,y=o=>{o.stopPropagation(),j(null),f(!1)},I=o=>{o.jid.includes(k(c.walletAddress))?g.push("/profile/"+c.walletAddress):g.push("/profile/"+te(o.jid.split("@")[0]))},D=(o,a)=>{o.stopPropagation(),S(a),j(o.currentTarget),f(!0)},s=(o,a)=>{o.ban_status==="clear"?h.banUserStanza(o.jid,r.jid):h.unbanUserStanza(o.jid,r.jid),h.getRoomMemberInfo(r.jid),y(a)};return e.jsxs(w,{children:[e.jsxs(p,{variant:"h5",children:["Members (",t.length,")"]}),e.jsx(K,{sx:{width:"100%",bgcolor:"background.paper"},children:t.map(o=>e.jsxs(Q,{dense:!0,onClick:()=>I(o),style:{flexDirection:"row",alignItems:"center"},children:[e.jsx(w,{alignItems:"center",justifyContent:"center",style:{background:"#003E9C",width:"40px",height:"40px",margin:5,display:"flex"},children:o.profile==="none"?e.jsx(p,{style:{color:"white"},children:o.name?o.name[0]:null}):e.jsx($,{style:{width:"40px",height:"40px"},variant:"square",src:o.profile})}),e.jsx(p,{children:o.jid.includes(k(c.walletAddress))?"You":o.name}),!o.jid.includes(k(c.walletAddress))&&(R==="moderator"||R==="owner")&&e.jsx(b,{"aria-label":"more",id:"long-button","aria-haspopup":"true",onClick:a=>D(a,o),children:e.jsx(Z,{})}),o.role==="owner"&&e.jsx(w,{style:{border:"1px solid",borderWidth:1,borderRadius:5,width:"70px",alignItems:"center",display:"flex",justifyContent:"center",marginLeft:10},children:e.jsx(p,{children:o.role})}),o.ban_status==="clear"?null:e.jsx(w,{style:{border:"1px solid",borderWidth:1,borderRadius:5,width:"70px",alignItems:"center",display:"flex",justifyContent:"center",marginLeft:10},children:e.jsx(p,{children:"banned"})}),e.jsx(ee,{id:"long-menu",MenuListProps:{"aria-labelledby":"long-button"},anchorEl:v,open:m,onClose:y,PaperProps:{style:{maxHeight:48*4.5,width:"20ch"}},children:e.jsx(oe,{onClick:a=>s(o,a),children:(o==null?void 0:o.ban_status)==="clear"?"Ban":"Unban"})})]},o.jid))})]})}function ye(){const{roomJID:n}=z();return u.useEffect(()=>{h.getRoomMemberInfo(n),h.getRoomInfo(n)},[]),e.jsxs(L,{maxWidth:"xl",children:[e.jsx(pe,{}),e.jsx(xe,{})]})}export{ye as default};
